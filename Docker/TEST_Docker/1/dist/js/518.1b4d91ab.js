"use strict";(self["webpackChunkclaimApp_web"]=self["webpackChunkclaimApp_web"]||[]).push([[518],{6512:function(e,t,s){s.d(t,{Bx:function(){return f},Ls:function(){return i},ME:function(){return g},Pg:function(){return a},R6:function(){return n},RD:function(){return p},Zj:function(){return u},gl:function(){return c},ix:function(){return m},j3:function(){return l},kD:function(){return d},l9:function(){return v},nm:function(){return r},vq:function(){return k}});var o=s(4471);const a=e=>(0,o.Z)({url:"/surveyor/getSurveyorVoList",method:"get",params:e}),n=e=>(0,o.Z)({url:"/check/submit",method:"post",data:e}),r=e=>(0,o.Z)({url:"/check/temporary",method:"post",data:e}),u=e=>(0,o.Z)({url:"/lossAssessment/propLossSubmit",method:"post",data:e}),l=e=>(0,o.Z)({url:"/trtc/getUserSig/"+e,method:"GET",headers:{"X-Silent-Error":"true"}}),c=e=>(0,o.Z)({url:"/lossAssessment/getLossInfo",method:"post",data:e}),i=e=>(0,o.Z)({url:"/check/getCheckInfoAll/"+e,method:"GET"}),d=e=>(0,o.Z)({url:"/check/addCheckLoss",method:"POST",data:e}),v=e=>o.Z.post("/taskReassignment/updateSurveyor",e),g=e=>o.Z.get("/survey/getBackMessages",e),p=e=>o.Z.post("/survey/backDispatch",e),m=e=>o.Z.get("/survey/getCancelledMessages",e),f=e=>o.Z.post("/survey/cancelledTask",e),k=e=>o.Z.post("/check/receiveSelfSurveyTask",e)},6518:function(e,t,s){s.r(t),s.d(t,{default:function(){return w}});s(7658);var o=s(6252),a=s(3577),n=s(2262),r=s(8339),u=s(571),l=s(6512),c=s(7500);const i={class:"guest-meeting-container"},d={key:0,class:"loading"},v={key:1,class:"error-message"},g={class:"retry-button-container"},p={key:2,class:"conference-view"},m={class:"video-container"},f={class:"controls"};var k={__name:"ViewGuest",setup(e){const t=(0,r.yj)(),s=(0,r.tv)(),k=(0,n.iH)(!0),h=(0,n.iH)(!1),y=(0,n.iH)(""),w=(0,n.iH)("æ­£åœ¨åŠ å…¥ä¼šè®®..."),b=async()=>{try{const e=t.query.roomId,s=t.query.userName||"guest";if(console.log("#roomIdroomIdroomId",e),!e)throw new Error("ç¼ºå°‘æˆ¿é—´å·å‚æ•°");console.log("###",e),w.value="æ­£åœ¨èŽ·å–ç”¨æˆ·ç­¾å...";const o=await(0,l.j3)(s);if(console.log("APIå“åº”:",o),!o.data||200!=o.data.code||!o.data.data)throw new Error("æ— æ³•ä»ŽåŽç«¯èŽ·å–æœ‰æ•ˆçš„UserSig");const a=o.data.data;console.log("ä»ŽAPIèŽ·å–UserSigæˆåŠŸ:",a.substring(0,20)+"..."),w.value="æ­£åœ¨ç™»å½•ä¼šè®®ç³»ç»Ÿ...",console.log("@@@###",{sdkAppId:c.pm.SDKAppID,userId:s,userSig:a}),await u.Wy.login({sdkAppId:c.pm.SDKAppID,userId:s,userSig:a}),w.value="æ­£åœ¨åŠ å…¥æˆ¿é—´...",await u.Wy.join(e,{isSeatEnabled:!1,isOpenCamera:!0,isOpenMicrophone:!0}),console.log("âœ… æˆåŠŸåŠ å…¥æˆ¿é—´:",e),await new Promise((e=>setTimeout(e,2e3))),h.value=!0,k.value=!1,console.log("ðŸ“º è§†é¢‘ä¼šè®®ç•Œé¢çŠ¶æ€:",{joined:h.value,loading:k.value,error:y.value}),console.log("ðŸŽ¥ ç­‰å¾…è§†é¢‘ç”»é¢åŠ è½½...")}catch(e){console.error("åŠ å…¥ä¼šè®®å¤±è´¥:",e),e.message?.includes("100004")||e.message?.includes("room not exist")?y.value="æˆ¿é—´ä¸å­˜åœ¨ï¼Œè¯·ç¡®ä¿ä¸»æŒäººå·²åˆ›å»ºä¼šè®®":e.response?y.value=`åŠ å…¥ä¼šè®®å¤±è´¥: ${e.response.status} ${e.response.data?.message||e.message}`:e.request?y.value="åŠ å…¥ä¼šè®®å¤±è´¥: æ— æ³•è¿žæŽ¥åˆ°æœåŠ¡å™¨":y.value="åŠ å…¥ä¼šè®®å¤±è´¥: "+(e.message||"æœªçŸ¥é”™è¯¯"),k.value=!1}},S=async()=>{try{await u.Wy.leave(),s.push("/")}catch(e){console.error("ç¦»å¼€ä¼šè®®å¤±è´¥:",e),s.push("/")}},Z=()=>{y.value="",k.value=!0,b()};return(0,o.bv)((()=>{b()})),(0,o.Ah)((()=>{h.value&&u.Wy.leave()})),(e,t)=>{const s=(0,o.up)("van-loading"),r=(0,o.up)("van-notice-bar"),l=(0,o.up)("van-button");return(0,o.wg)(),(0,o.iD)("div",i,[k.value?((0,o.wg)(),(0,o.iD)("div",d,[(0,o.Wm)(s,{size:"1.5rem",vertical:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(w.value),1)])),_:1})])):(0,o.kq)("",!0),y.value?((0,o.wg)(),(0,o.iD)("div",v,[(0,o.Wm)(r,{color:"#f56565",background:"#fff5f5","left-icon":"warning-o",text:y.value},null,8,["text"]),(0,o._)("div",g,[(0,o.Wm)(l,{onClick:Z,type:"default",size:"small",block:""},{default:(0,o.w5)((()=>[...t[0]||(t[0]=[(0,o.Uk)(" é‡æ–°å°è¯• ",-1)])])),_:1})])])):(0,o.kq)("",!0),h.value?((0,o.wg)(),(0,o.iD)("div",p,[(0,o._)("div",m,[(0,o.Wm)((0,n.SU)(u.on))]),(0,o._)("div",f,[(0,o.Wm)(l,{type:"danger",onClick:S,block:""},{default:(0,o.w5)((()=>[...t[1]||(t[1]=[(0,o.Uk)(" ç¦»å¼€ä¼šè®® ",-1)])])),_:1})])])):(0,o.kq)("",!0)])}}},h=s(3744);const y=(0,h.Z)(k,[["__scopeId","data-v-a5367ff4"]]);var w=y}}]);